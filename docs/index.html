<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AuraOS - Intelligent Mood Light</title>
    <meta name="description" content="Ein intelligentes IoT-Stimmungslicht, das die Weltlage durch KI-gestützte Sentiment-Analyse visualisiert">
    <meta name="keywords" content="IoT, ESP32, Smart Home, LED, Stimmungslicht, Home Assistant, MQTT">
    
    <!-- Open Graph -->
    <meta property="og:title" content="AuraOS - Intelligent Mood Light">
    <meta property="og:description" content="Visualisiert die Weltlage durch dynamische LED-Beleuchtung basierend auf Sentiment-Analyse">
    <meta property="og:type" content="website">

    <!-- Chart.js for Statistics -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-adapter-moment/1.0.1/chartjs-adapter-moment.min.js"></script>

    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            --primary-color: #8A2BE2;
            --secondary-color: #1E90FF;
            --accent-color: #FF6B35;
            --background: #f8f9fa;
            --surface: #ffffff;
            --text-primary: #2c3e50;
            --text-secondary: #6c757d;
            --gradient: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            --border-color: #e9ecef;
            --shadow: rgba(0, 0, 0, 0.1);
        }

        /* Dynamic theme based on sentiment */
        .sentiment-very-negative {
            --primary-color: #dc3545;
            --secondary-color: #fd7e14;
            --gradient: linear-gradient(135deg, #dc3545, #fd7e14);
        }

        .sentiment-negative {
            --primary-color: #fd7e14;
            --secondary-color: #ffc107;
            --gradient: linear-gradient(135deg, #fd7e14, #ffc107);
        }

        .sentiment-neutral {
            --primary-color: #17a2b8;
            --secondary-color: #6f42c1;
            --gradient: linear-gradient(135deg, #17a2b8, #6f42c1);
        }

        .sentiment-positive {
            --primary-color: #6f42c1;
            --secondary-color: #8A2BE2;
            --gradient: linear-gradient(135deg, #6f42c1, #8A2BE2);
        }

        .sentiment-very-positive {
            --primary-color: #8A2BE2;
            --secondary-color: #9c27b0;
            --gradient: linear-gradient(135deg, #8A2BE2, #9c27b0);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--background);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
        }

        .hero {
            height: 100vh;
            background: var(--gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            text-align: center;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><radialGradient id="g"><stop offset="0%" stop-color="%23ffffff" stop-opacity="0.1"/><stop offset="100%" stop-color="%23ffffff" stop-opacity="0"/></radialGradient></defs><circle cx="20" cy="20" r="2" fill="url(%23g)"/><circle cx="80" cy="40" r="1.5" fill="url(%23g)"/><circle cx="40" cy="80" r="1" fill="url(%23g)"/><circle cx="90" cy="80" r="1.5" fill="url(%23g)"/><circle cx="10" cy="60" r="1" fill="url(%23g)"/></svg>') repeat;
            animation: float 20s infinite ease-in-out;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) translateX(0); }
            25% { transform: translateY(-20px) translateX(10px); }
            50% { transform: translateY(-10px) translateX(-5px); }
            75% { transform: translateY(-30px) translateX(15px); }
        }

        .hero-content {
            position: relative;
            z-index: 2;
            max-width: 800px;
            padding: 0 20px;
        }

        .logo {
            font-size: 4rem;
            font-weight: bold;
            margin-bottom: 20px;
            background: linear-gradient(45deg, #ffffff, #f0f0f0);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 4px 20px rgba(255,255,255,0.3);
        }

        .tagline {
            font-size: 1.5rem;
            margin-bottom: 30px;
            color: rgba(255,255,255,0.9);
            font-weight: 300;
        }

        .cta-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 40px;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 600;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .btn-primary {
            background: rgba(255,255,255,0.2);
            color: white;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.3);
        }

        .btn-primary:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }

        .btn-secondary {
            background: transparent;
            color: white;
            border: 2px solid rgba(255,255,255,0.5);
        }

        .btn-secondary:hover {
            background: rgba(255,255,255,0.1);
            border-color: white;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .section {
            padding: 100px 0;
        }

        .section-title {
            text-align: center;
            font-size: 3rem;
            margin-bottom: 60px;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 40px;
            margin-top: 60px;
        }

        .feature-card {
            background: var(--surface);
            padding: 40px;
            border-radius: 20px;
            border: 1px solid var(--border-color);
            box-shadow: 0 4px 6px var(--shadow);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .feature-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--gradient);
        }

        .feature-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 8px 25px var(--shadow);
            border-color: var(--primary-color);
        }

        .feature-icon {
            font-size: 3rem;
            margin-bottom: 20px;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .feature-title {
            font-size: 1.5rem;
            margin-bottom: 15px;
            color: var(--text-primary);
        }

        .feature-description {
            color: var(--text-secondary);
            line-height: 1.6;
        }

        .demo-section {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            position: relative;
        }

        .mood-visualizer {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 40px 0;
            flex-wrap: wrap;
        }

        .mood-color {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.9rem;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            border: 3px solid transparent;
        }

        .mood-color:hover {
            transform: scale(1.1);
            border-color: white;
        }

        .mood-negative { background: #FF0000; }
        .mood-somewhat-negative { background: #FFA500; }
        .mood-neutral { background: #1E90FF; }
        .mood-positive { background: #545DF0; }
        .mood-very-positive { background: #8A2BE2; }

        .tech-stack {
            display: flex;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
            margin-top: 40px;
        }

        .tech-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            padding: 20px;
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            transition: all 0.3s ease;
        }

        .tech-item:hover {
            background: rgba(255,255,255,0.1);
            transform: translateY(-5px);
        }

        .tech-icon {
            font-size: 2.5rem;
        }

        .footer {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: #ecf0f1;
            padding: 60px 0 30px;
            border-top: 4px solid var(--primary-color);
            text-align: center;
            margin-top: 80px;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .footer-links a {
            color: #bdc3c7;
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .footer-links a:hover {
            color: #ecf0f1;
        }

        .social-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 30px 0;
        }

        .social-links a {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: rgba(255,255,255,0.1);
            color: white;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .social-links a:hover {
            background: var(--primary-color);
            transform: translateY(-3px);
        }

        @media (max-width: 768px) {
            .logo { font-size: 2.5rem; }
            .tagline { font-size: 1.2rem; }
            .section-title { font-size: 2rem; }
            .cta-buttons { flex-direction: column; align-items: center; }
            .mood-color { width: 60px; height: 60px; font-size: 0.8rem; }
        }

        .scroll-indicator {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            color: rgba(255,255,255,0.7);
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateX(-50%) translateY(0); }
            40% { transform: translateX(-50%) translateY(-10px); }
            60% { transform: translateX(-50%) translateY(-5px); }
        }

        /* Statistics Section Styles */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            margin: 40px 0;
        }

        .stat-card {
            background: var(--surface);
            padding: 30px;
            border-radius: 20px;
            border: 1px solid var(--border-color);
            box-shadow: 0 4px 6px var(--shadow);
            text-align: center;
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px var(--shadow);
        }

        .stat-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 10px;
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--text-primary);
            margin-bottom: 10px;
        }

        .trend-indicator {
            font-size: 0.9rem;
            padding: 5px 15px;
            border-radius: 20px;
            display: inline-block;
            margin-top: 10px;
        }

        .trend-up {
            background: rgba(46, 204, 113, 0.1);
            color: #2ecc71;
        }

        .trend-down {
            background: rgba(231, 76, 60, 0.1);
            color: #e74c3c;
        }

        .trend-neutral {
            background: rgba(149, 165, 166, 0.1);
            color: #95a5a6;
        }

        .chart-container {
            position: relative;
            height: 400px;
            margin: 20px 0;
        }

        .chart-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .chart-tab {
            padding: 10px 20px;
            border: 2px solid var(--border-color);
            border-radius: 25px;
            background: var(--surface);
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .chart-tab.active {
            background: var(--gradient);
            color: white;
            border-color: transparent;
        }

        .chart-tab:hover:not(.active) {
            border-color: var(--primary-color);
            transform: translateY(-2px);
        }

        .analysis-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 40px;
            margin-top: 60px;
        }

        .analysis-card {
            background: var(--surface);
            padding: 30px;
            border-radius: 20px;
            border: 1px solid var(--border-color);
            box-shadow: 0 4px 6px var(--shadow);
        }

        .analysis-card h3 {
            margin-bottom: 10px;
            color: var(--text-primary);
        }

        .analysis-subtitle {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 20px;
        }

        .summary-card {
            background: linear-gradient(135deg, rgba(138, 43, 226, 0.05), rgba(30, 144, 255, 0.05));
            padding: 40px;
            border-radius: 20px;
            border: 1px solid var(--border-color);
            margin: 40px 0;
            text-align: center;
        }

        .summary-card h3 {
            font-size: 1.8rem;
            margin-bottom: 20px;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .summary-text {
            font-size: 1.1rem;
            line-height: 1.8;
            color: var(--text-primary);
        }

        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }

            .analysis-grid {
                grid-template-columns: 1fr;
            }

            .chart-container {
                height: 300px;
            }
        }
    </style>
</head>
<body>
    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-content">
            <h1 class="logo">AuraOS</h1>
            <p class="tagline">Intelligentes Stimmungslicht für das Smart Home</p>
            <p style="font-size: 1.1rem; margin-bottom: 20px; color: rgba(255,255,255,0.8);">
                Visualisiert die Weltlage durch KI-gestützte Sentiment-Analyse und dynamische LED-Beleuchtung
            </p>
            
            <!-- Current Sentiment Display -->
            <div class="sentiment-display" style="margin: 30px 0;">
                <div style="background: rgba(255,255,255,0.1); backdrop-filter: blur(10px); border-radius: 20px; padding: 25px; display: inline-block; border: 1px solid rgba(255,255,255,0.2);">
                    <div style="font-size: 1.1rem; margin-bottom: 10px; opacity: 0.9;">Aktuelle Weltlage</div>
                    <div style="display: flex; align-items: center; gap: 15px;">
                        <div class="sentiment-indicator" id="hero-sentiment-indicator" style="width: 40px; height: 40px; border-radius: 50%; background: var(--primary-color); border: 3px solid rgba(255,255,255,0.3);"></div>
                        <div>
                            <div class="sentiment-value" id="hero-sentiment-value" style="font-size: 2rem; font-weight: bold; margin-bottom: 5px;">0.0</div>
                            <div class="sentiment-label" id="hero-sentiment-label" style="font-size: 0.9rem; opacity: 0.8;">Neutral</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="cta-buttons">
                <a href="#screenshots" class="btn btn-primary">
                    Ansichten
                </a>
                <a href="https://github.com/Revisor01/auraos-moodlight" class="btn btn-secondary">
                    GitHub Repository
                </a>
            </div>
        </div>
        <div class="scroll-indicator">
            <div style="font-size: 2rem;">↓</div>
            <div>Scroll to explore</div>
        </div>
    </section>

    <!-- Features Section -->
    <section class="section">
        <div class="container">
            <h2 class="section-title">Features</h2>
            
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">●</div>
                    <h3 class="feature-title">Sentiment-Visualisierung</h3>
                    <p class="feature-description">
                        Analysiert aktuelle Nachrichten und zeigt die Weltlage durch eine 5-stufige Farbskala von Rot (negativ) bis Violett (positiv) an.
                    </p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">●</div>
                    <h3 class="feature-title">Smart Home Integration</h3>
                    <p class="feature-description">
                        Native Home Assistant Integration mit MQTT Auto-Discovery, Sensor-Daten und vollständiger Steuerung über das Smart Home System.
                    </p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">●</div>
                    <h3 class="feature-title">Web Interface</h3>
                    <p class="feature-description">
                        Responsive Web-Oberfläche mit Dashboard, Konfiguration, Statistiken und Diagnose-Tools. Dark/Light Theme Support inklusive.
                    </p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">●</div>
                    <h3 class="feature-title">Datenmanagement</h3>
                    <p class="feature-description">
                        CSV Export/Import für historische Daten, intelligentes Buffering und sichere Backup-Systeme für alle Konfigurationen.
                    </p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">●</div>
                    <h3 class="feature-title">Systemüberwachung</h3>
                    <p class="feature-description">
                        Umfassende Überwachung mit Watchdog, Memory-Monitoring, Network-Diagnostics und automatischer Fehlerbehandlung.
                    </p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">●</div>
                    <h3 class="feature-title">OTA Updates</h3>
                    <p class="feature-description">
                        Over-the-Air Firmware-Updates über das Web-Interface. Einfache Wartung und Feature-Updates ohne physischen Zugriff.
                    </p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">●</div>
                    <h3 class="feature-title">Erweiterte Statistiken</h3>
                    <p class="feature-description">
                        Detaillierte Analyse historischer Sentiment-Daten mit interaktiven Charts, Trends und Durchschnittswerten über verschiedene Zeiträume.
                    </p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">●</div>
                    <h3 class="feature-title">Adaptive Beleuchtung</h3>
                    <p class="feature-description">
                        Intelligente Helligkeitsanpassung basierend auf Tageszeit, Umgebungslicht und benutzerdefinierten Szenarien für optimales Ambient Light.
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- Statistics & Trends Section -->
    <section class="section" id="statistics" style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);">
        <div class="container">
            <h2 class="section-title">Statistiken & Trends</h2>
            <p style="text-align: center; font-size: 1.2rem; margin-bottom: 40px; color: var(--text-secondary);">
                Live-Daten der weltweiten Sentiment-Analyse in Echtzeit
            </p>

            <!-- Statistics Cards -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon"><i class="fas fa-balance-scale"></i></div>
                    <div class="stat-label">Durchschnitt</div>
                    <div class="stat-value" id="stat-avg">--</div>
                    <div class="trend-indicator trend-neutral" id="stat-avg-trend">Lädt...</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon"><i class="fas fa-arrow-down"></i></div>
                    <div class="stat-label">Minimum</div>
                    <div class="stat-value" id="stat-min" style="color: #e74c3c;">--</div>
                    <div class="stat-label" id="stat-min-date" style="margin-top: 10px; font-size: 0.8rem;">--</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon"><i class="fas fa-arrow-up"></i></div>
                    <div class="stat-label">Maximum</div>
                    <div class="stat-value" id="stat-max" style="color: #2ecc71;">--</div>
                    <div class="stat-label" id="stat-max-date" style="margin-top: 10px; font-size: 0.8rem;">--</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon"><i class="fas fa-chart-pie"></i></div>
                    <div class="stat-label">Messungen</div>
                    <div class="stat-value" id="stat-count">--</div>
                    <div class="stat-label" style="margin-top: 10px; font-size: 0.8rem;">Gesamt</div>
                </div>
            </div>

            <!-- Main Chart with Tabs -->
            <div style="margin-top: 60px; background: var(--surface); padding: 40px; border-radius: 20px; border: 1px solid var(--border-color); box-shadow: 0 4px 6px var(--shadow);">
                <h3 style="margin-bottom: 20px; color: var(--text-primary);">Stimmungsverlauf</h3>
                <div class="chart-tabs">
                    <div class="chart-tab active" data-period="all" onclick="switchChartPeriod('all')">Gesamter Zeitraum</div>
                    <div class="chart-tab" data-period="week" onclick="switchChartPeriod('week')">Letzte Woche</div>
                    <div class="chart-tab" data-period="day" onclick="switchChartPeriod('day')">Letzter Tag</div>
                </div>
                <div class="chart-container">
                    <canvas id="main-chart"></canvas>
                </div>
            </div>

            <!-- Summary Card -->
            <div class="summary-card">
                <h3>Zusammenfassung der Weltlage</h3>
                <div class="summary-text" id="summary-text">
                    Daten werden geladen...
                </div>
            </div>

            <!-- Analysis Charts Grid -->
            <div class="analysis-grid">
                <div class="analysis-card">
                    <h3>Stündliche Analyse</h3>
                    <div class="analysis-subtitle">Durchschnittswerte nach Tageszeit</div>
                    <div class="chart-container" style="height: 300px;">
                        <canvas id="hourly-chart"></canvas>
                    </div>
                </div>
                <div class="analysis-card">
                    <h3>Wochentag-Analyse</h3>
                    <div class="analysis-subtitle">Durchschnittliche Stimmung nach Wochentag</div>
                    <div class="chart-container" style="height: 300px;">
                        <canvas id="weekday-chart"></canvas>
                    </div>
                </div>
                <div class="analysis-card">
                    <h3>Stimmungsverteilung</h3>
                    <div class="analysis-subtitle">Histogramm der Stimmungswerte</div>
                    <div class="chart-container" style="height: 300px;">
                        <canvas id="distribution-chart"></canvas>
                    </div>
                </div>
                <div class="analysis-card">
                    <h3>Trendanalyse</h3>
                    <div class="analysis-subtitle">Langfristige Entwicklung</div>
                    <div class="chart-container" style="height: 300px;">
                        <canvas id="trend-chart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </section>


    <!-- Screenshots Section -->
    <section class="section" id="screenshots" style="background: var(--surface);">
        <div class="container">
            <h2 class="section-title">AuraOS Ansichten</h2>
            <p style="text-align: center; font-size: 1.2rem; margin-bottom: 40px; color: var(--text-secondary);">
                Benutzeroberfläche und Funktionen des intelligenten Stimmungslichts
            </p>
            
            <div class="screenshots-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 30px; margin-top: 40px;">
                <div class="screenshot-card" style="background: var(--surface); border-radius: 15px; border: 1px solid var(--border-color); box-shadow: 0 4px 6px var(--shadow); overflow: hidden;">
                    <img src="main.png" alt="Dashboard Screenshot" style="width: 100%; height: auto; display: block;">
                    <div style="padding: 20px;">
                        <h3 style="margin-bottom: 10px; color: var(--text-primary);">Dashboard</h3>
                        <p style="color: var(--text-secondary); line-height: 1.5;">
                            Hauptübersicht mit aktueller Stimmungslage, Systemstatus und Sensor-Werten. Zeigt LED-Status und Verbindungsqualität.
                        </p>
                    </div>
                </div>

                <div class="screenshot-card" style="background: var(--surface); border-radius: 15px; border: 1px solid var(--border-color); box-shadow: 0 4px 6px var(--shadow); overflow: hidden;">
                    <img src="farben.png" alt="Farbkonfiguration Screenshot" style="width: 100%; height: auto; display: block;">
                    <div style="padding: 20px;">
                        <h3 style="margin-bottom: 10px; color: var(--text-primary);">Farbkonfiguration</h3>
                        <p style="color: var(--text-secondary); line-height: 1.5;">
                            Intuitive Farbauswahl für jede Sentiment-Kategorie. Anpassbare RGB-Werte für vollständige Personalisierung.
                        </p>
                    </div>
                </div>

                <div class="screenshot-card" style="background: var(--surface); border-radius: 15px; border: 1px solid var(--border-color); box-shadow: 0 4px 6px var(--shadow); overflow: hidden;">
                    <img src="wlan.png" alt="WLAN Konfiguration Screenshot" style="width: 100%; height: auto; display: block;">
                    <div style="padding: 20px;">
                        <h3 style="margin-bottom: 10px; color: var(--text-primary);">WLAN-Konfiguration</h3>
                        <p style="color: var(--text-secondary); line-height: 1.5;">
                            Einfache Netzwerk-Einrichtung mit SSID-Scanner und automatischer Verbindungsverwaltung.
                        </p>
                    </div>
                </div>

                <div class="screenshot-card" style="background: var(--surface); border-radius: 15px; border: 1px solid var(--border-color); box-shadow: 0 4px 6px var(--shadow); overflow: hidden;">
                    <img src="statistik1.png" alt="Statistik Screenshot" style="width: 100%; height: auto; display: block;">
                    <div style="padding: 20px;">
                        <h3 style="margin-bottom: 10px; color: var(--text-primary);">Statistiken</h3>
                        <p style="color: var(--text-secondary); line-height: 1.5;">
                            Detaillierte Charts und Trends der Sentiment-Daten. Historische Analyse und Durchschnittswerte über verschiedene Zeiträume.
                        </p>
                    </div>
                </div>

                <div class="screenshot-card" style="background: var(--surface); border-radius: 15px; border: 1px solid var(--border-color); box-shadow: 0 4px 6px var(--shadow); overflow: hidden;">
                    <img src="mqtt.png" alt="MQTT Integration Screenshot" style="width: 100%; height: auto; display: block; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 200px;">
                    <div style="padding: 20px;">
                        <h3 style="margin-bottom: 10px; color: var(--text-primary);">MQTT & Home Assistant</h3>
                        <p style="color: var(--text-secondary); line-height: 1.5;">
                            Vollständige Home Assistant Integration mit Auto-Discovery. Alle Sensoren und Steuerungselemente automatisch verfügbar.
                        </p>
                    </div>
                </div>

                <div class="screenshot-card" style="background: var(--surface); border-radius: 15px; border: 1px solid var(--border-color); box-shadow: 0 4px 6px var(--shadow); overflow: hidden;">
                    <img src="settings.png" alt="Settings Screenshot" style="width: 100%; height: auto; display: block; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); min-height: 200px;">
                    <div style="padding: 20px;">
                        <h3 style="margin-bottom: 10px; color: var(--text-primary);">Intervall-Einstellungen</h3>
                        <p style="color: var(--text-secondary); line-height: 1.5;">
                            Konfigurierbare Update-Intervalle für Sentiment-Analyse und Sensor-Abfragen. Anpassbare Helligkeit und Welleneffekt-Einstellungen.
                        </p>
                    </div>
                </div>

                <div class="screenshot-card" style="background: var(--surface); border-radius: 15px; border: 1px solid var(--border-color); box-shadow: 0 4px 6px var(--shadow); overflow: hidden;">
                    <img src="ota.png" alt="OTA Update Screenshot" style="width: 100%; height: auto; display: block; background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); min-height: 200px;">
                    <div style="padding: 20px;">
                        <h3 style="margin-bottom: 10px; color: --text-primary);">Over-The-Air Updates</h3>
                        <p style="color: var(--text-secondary); line-height: 1.5;">
                            Firmware und Web-UI Updates direkt über WiFi. Kein USB-Kabel erforderlich für Updates im Betrieb.
                        </p>
                    </div>
                </div>

                <div class="screenshot-card" style="background: var(--surface); border-radius: 15px; border: 1px solid var(--border-color); box-shadow: 0 4px 6px var(--shadow); overflow: hidden;">
                    <img src="pins.png" alt="Hardware Pin Configuration Screenshot" style="width: 100%; height: auto; display: block; background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); min-height: 200px;">
                    <div style="padding: 20px;">
                        <h3 style="margin-bottom: 10px; color: var(--text-primary);">Hardware-Konfiguration</h3>
                        <p style="color: var(--text-secondary); line-height: 1.5;">
                            Flexible Pin-Konfiguration für LEDs und Sensoren. Anpassbar für verschiedene ESP32-Boards und LED-Strips.
                        </p>
                    </div>
                </div>

                <div class="screenshot-card" style="background: var(--surface); border-radius: 15px; border: 1px solid var(--border-color); box-shadow: 0 4px 6px var(--shadow); overflow: hidden;">
                    <img src="darkmode.png" alt="Dark Mode Screenshot" style="width: 100%; height: auto; display: block; background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%); min-height: 200px;">
                    <div style="padding: 20px;">
                        <h3 style="margin-bottom: 10px; color: var(--text-primary);">Dark Mode</h3>
                        <p style="color: var(--text-secondary); line-height: 1.5;">
                            Umschaltbarer Dark Mode für angenehmes Arbeiten bei Nacht. Alle UI-Elemente passen sich automatisch an.
                        </p>
                    </div>
                </div>

                <div class="screenshot-card" style="background: var(--surface); border-radius: 15px; border: 1px solid var(--border-color); box-shadow: 0 4px 6px var(--shadow); overflow: hidden;">
                    <img src="info.png" alt="Hardware Information Screenshot" style="width: 100%; height: auto; display: block; background: linear-gradient(135deg, #3498db 0%, #2980b9 100%); min-height: 200px;">
                    <div style="padding: 20px;">
                        <h3 style="margin-bottom: 10px; color: var(--text-primary);">Hardware-Informationen</h3>
                        <p style="color: var(--text-secondary); line-height: 1.5;">
                            Detaillierte Systeminfos: Speicher, CPU-Temperatur, WiFi-Signal, Laufzeit und Firmware-Version auf einen Blick.
                        </p>
                    </div>
                </div>

                <div class="screenshot-card" style="background: var(--surface); border-radius: 15px; border: 1px solid var(--border-color); box-shadow: 0 4px 6px var(--shadow); overflow: hidden;">
                    <img src="diagnostics.png" alt="System Diagnostics Screenshot" style="width: 100%; height: auto; display: block; background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%); min-height: 200px;">
                    <div style="padding: 20px;">
                        <h3 style="margin-bottom: 10px; color: var(--text-primary);">System-Diagnose</h3>
                        <p style="color: var(--text-secondary); line-height: 1.5;">
                            Umfassendes Diagnose-Tool mit Echtzeit-Metriken, Logs und Wartungsfunktionen für Systemüberwachung und Fehlerbehebung.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Tech Stack Section -->
    <section class="section">
        <div class="container">
            <h2 class="section-title">Technologie-Stack</h2>
            
            <div class="tech-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 25px; margin-top: 40px;">
                <div class="tech-card" style="background: var(--surface); padding: 25px; border-radius: 15px; border: 1px solid var(--border-color); box-shadow: 0 4px 6px var(--shadow); text-align: center; transition: all 0.3s ease;">
                    <div class="tech-icon" style="font-size: 2.5rem; margin-bottom: 15px; color: var(--primary-color);">ESP32</div>
                    <h3 style="margin-bottom: 8px; color: var(--text-primary);">ESP32 Mikrocontroller</h3>
                    <p style="color: var(--text-secondary); font-size: 0.9rem;">Arduino Framework, WiFi & Bluetooth integriert</p>
                </div>
                
                <div class="tech-card" style="background: var(--surface); padding: 25px; border-radius: 15px; border: 1px solid var(--border-color); box-shadow: 0 4px 6px var(--shadow); text-align: center; transition: all 0.3s ease;">
                    <div class="tech-icon" style="font-size: 2.5rem; margin-bottom: 15px; color: var(--secondary-color);">LED</div>
                    <h3 style="margin-bottom: 8px; color: var(--text-primary);">NeoPixel LEDs</h3>
                    <p style="color: var(--text-secondary); font-size: 0.9rem;">WS2812B/WS2813 adressierbare RGB-LEDs</p>
                </div>
                
                <div class="tech-card" style="background: var(--surface); padding: 25px; border-radius: 15px; border: 1px solid var(--border-color); box-shadow: 0 4px 6px var(--shadow); text-align: center; transition: all 0.3s ease;">
                    <div class="tech-icon" style="font-size: 2.5rem; margin-bottom: 15px; color: var(--accent-color);">MQTT</div>
                    <h3 style="margin-bottom: 8px; color: var(--text-primary);">MQTT Integration</h3>
                    <p style="color: var(--text-secondary); font-size: 0.9rem;">Home Assistant Auto-Discovery</p>
                </div>
                
                <div class="tech-card" style="background: var(--surface); padding: 25px; border-radius: 15px; border: 1px solid var(--border-color); box-shadow: 0 4px 6px var(--shadow); text-align: center; transition: all 0.3s ease;">
                    <div class="tech-icon" style="font-size: 2.5rem; margin-bottom: 15px; color: var(--primary-color);">DHT</div>
                    <h3 style="margin-bottom: 8px; color: var(--text-primary);">DHT22 Sensor</h3>
                    <p style="color: var(--text-secondary); font-size: 0.9rem;">Temperatur & Luftfeuchtigkeit</p>
                </div>
                
                <div class="tech-card" style="background: var(--surface); padding: 25px; border-radius: 15px; border: 1px solid var(--border-color); box-shadow: 0 4px 6px var(--shadow); text-align: center; transition: all 0.3s ease;">
                    <div class="tech-icon" style="font-size: 2.5rem; margin-bottom: 15px; color: var(--secondary-color);">AI</div>
                    <h3 style="margin-bottom: 8px; color: var(--text-primary);">AI Sentiment API</h3>
                    <p style="color: var(--text-secondary); font-size: 0.9rem;">Automatische Nachrichten-Analyse</p>
                </div>
                
                <div class="tech-card" style="background: var(--surface); padding: 25px; border-radius: 15px; border: 1px solid var(--border-color); box-shadow: 0 4px 6px var(--shadow); text-align: center; transition: all 0.3s ease;">
                    <div class="tech-icon" style="font-size: 2.5rem; margin-bottom: 15px; color: var(--accent-color);">PIO</div>
                    <h3 style="margin-bottom: 8px; color: var(--text-primary);">PlatformIO</h3>
                    <p style="color: var(--text-secondary); font-size: 0.9rem;">Modernes Build-System & Libraries</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-links">
                <a href="https://github.com/Revisor01/auraos-moodlight">GitHub</a>
                <a href="https://github.com/Revisor01/auraos-moodlight/wiki">Dokumentation</a>
                <a href="https://github.com/Revisor01/auraos-moodlight/releases">Releases</a>
                <a href="https://github.com/Revisor01/auraos-moodlight/issues">Issues</a>
                <a href="https://github.com/Revisor01/auraos-moodlight/discussions">Community</a>
            </div>
            
            <div class="social-links">
                <a href="https://github.com/Revisor01" title="GitHub">
                    <span style="font-size: 1.5rem;">GH</span>
                </a>
                <a href="https://twitter.com/Revisor01" title="Twitter">
                    <span style="font-size: 1.5rem;">TW</span>
                </a>
                <a href="https://linkedin.com/in/revisor01" title="LinkedIn">
                    <span style="font-size: 1.5rem;">LI</span>
                </a>
            </div>
            
            <p style="color: var(--text-secondary); margin-top: 30px;">
                &copy; 2024 AuraOS. Open Source unter MIT-Lizenz.<br>
                Entwickelt für das Smart Home
            </p>
        </div>
    </footer>

    <script>
        // Smooth scrolling
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                document.querySelector(this.getAttribute('href')).scrollIntoView({
                    behavior: 'smooth'
                });
            });
        });

        // Interactive mood colors
        document.querySelectorAll('.mood-color').forEach(color => {
            color.addEventListener('click', function() {
                const sentiment = this.dataset.sentiment;
                document.getElementById('current-sentiment').textContent = sentiment;
                
                // Remove active class from all
                document.querySelectorAll('.mood-color').forEach(c => c.style.borderColor = 'transparent');
                // Add active class to clicked
                this.style.borderColor = 'white';
            });
        });

        // Simulate real-time sentiment updates
        function updateSentiment() {
            const sentimentValue = (Math.random() * 2 - 1).toFixed(1); // -1.0 to 1.0
            document.getElementById('current-sentiment').textContent = sentimentValue;
            
            // Highlight corresponding color
            document.querySelectorAll('.mood-color').forEach(color => {
                const colorSentiment = parseFloat(color.dataset.sentiment);
                const currentSentiment = parseFloat(sentimentValue);
                
                if (Math.abs(colorSentiment - currentSentiment) < 0.3) {
                    color.style.borderColor = 'white';
                    color.style.transform = 'scale(1.1)';
                } else {
                    color.style.borderColor = 'transparent';
                    color.style.transform = 'scale(1)';
                }
            });
        }

        // API-basierte Sentiment-Aktualisierung
        async function fetchRealSentiment() {
            try {
                const response = await fetch('https://analyse.godsapp.de/api/news/total_sentiment');
                const data = await response.json();
                const sentiment = data.total_sentiment || 0.0;
                // Auf 2 Nachkommastellen runden
                return parseFloat(sentiment).toFixed(2);
            } catch (error) {
                console.error('API-Fehler:', error);
                // Bei Fehler: letzten bekannten Wert beibehalten (kein Zufallswert!)
                return null;
            }
        }

        async function updateRealSentiment() {
            const sentiment = await fetchRealSentiment();

            // Wenn API-Fehler, nichts updaten
            if (sentiment === null) {
                console.log('API nicht erreichbar, behalte aktuellen Wert');
                return;
            }

            const sentimentValue = parseFloat(sentiment);

            // Update hero display
            const heroSentimentValue = document.getElementById('hero-sentiment-value');
            const heroSentimentLabel = document.getElementById('hero-sentiment-label');
            const heroSentimentIndicator = document.getElementById('hero-sentiment-indicator');

            if (heroSentimentValue) {
                heroSentimentValue.textContent = sentiment;
                
                // Update label based on sentiment
                if (sentimentValue <= -0.6) {
                    heroSentimentLabel.textContent = 'Sehr negativ';
                } else if (sentimentValue <= -0.2) {
                    heroSentimentLabel.textContent = 'Negativ';
                } else if (sentimentValue <= 0.2) {
                    heroSentimentLabel.textContent = 'Neutral';
                } else if (sentimentValue <= 0.6) {
                    heroSentimentLabel.textContent = 'Positiv';
                } else {
                    heroSentimentLabel.textContent = 'Sehr positiv';
                }
            }
            
            // Update theme based on sentiment
            updateTheme(sentimentValue);
        }

        function updateTheme(sentiment) {
            const body = document.body;
            
            // Remove existing sentiment classes
            body.classList.remove('sentiment-very-negative', 'sentiment-negative', 'sentiment-neutral', 'sentiment-positive', 'sentiment-very-positive');
            
            // Add appropriate sentiment class
            if (sentiment <= -0.6) {
                body.classList.add('sentiment-very-negative');
            } else if (sentiment <= -0.2) {
                body.classList.add('sentiment-negative');
            } else if (sentiment <= 0.2) {
                body.classList.add('sentiment-neutral');
            } else if (sentiment <= 0.6) {
                body.classList.add('sentiment-positive');
            } else {
                body.classList.add('sentiment-very-positive');
            }
        }

        // Update sentiment every 30 seconds for real API data
        setInterval(updateRealSentiment, 30000);
        
        // Initial update
        updateRealSentiment();

        // Parallax effect for hero
        window.addEventListener('scroll', () => {
            const scrolled = window.pageYOffset;
            const hero = document.querySelector('.hero');
            const rate = scrolled * -0.5;
            hero.style.transform = `translateY(${rate}px)`;
        });

        // ===== STATISTICS & CHARTS =====
        const API_BASE = 'https://analyse.godsapp.de';
        let allHistoryData = [];
        let charts = {};
        let currentPeriod = 'all';

        // Load all statistics data
        async function loadStatistics() {
            try {
                // Load all available history data (unlimited)
                const historyResponse = await fetch(`${API_BASE}/api/moodlight/history`);
                const historyData = await historyResponse.json();

                console.log('History data:', historyData); // Debug

                if (historyData.data && historyData.data.length > 0) {
                    allHistoryData = historyData.data;
                    processStatistics();
                    createAllCharts();
                }

                // Load trend data
                const trendResponse = await fetch(`${API_BASE}/api/moodlight/trend`);
                const trendData = await trendResponse.json();

                console.log('Trend data:', trendData); // Debug

                if (trendData.status === 'success') {
                    updateTrendIndicator(trendData);
                }

            } catch (error) {
                console.error('Error loading statistics:', error);
            }
        }

        // Process statistics from history data
        function processStatistics() {
            if (!allHistoryData || allHistoryData.length === 0) return;

            const values = allHistoryData.map(item => item.sentiment_score);
            const min = Math.min(...values);
            const max = Math.max(...values);
            const avg = values.reduce((a, b) => a + b, 0) / values.length;

            // Find min/max dates
            const minItem = allHistoryData.find(item => item.sentiment_score === min);
            const maxItem = allHistoryData.find(item => item.sentiment_score === max);

            // Update stat cards
            document.getElementById('stat-avg').textContent = avg.toFixed(2);
            document.getElementById('stat-min').textContent = min.toFixed(2);
            document.getElementById('stat-max').textContent = max.toFixed(2);
            document.getElementById('stat-count').textContent = allHistoryData.length.toLocaleString();

            if (minItem) {
                const minDate = new Date(minItem.timestamp).toLocaleDateString('de-DE', {
                    day: '2-digit', month: '2-digit', hour: '2-digit', minute: '2-digit'
                });
                document.getElementById('stat-min-date').textContent = minDate;
            }

            if (maxItem) {
                const maxDate = new Date(maxItem.timestamp).toLocaleDateString('de-DE', {
                    day: '2-digit', month: '2-digit', hour: '2-digit', minute: '2-digit'
                });
                document.getElementById('stat-max-date').textContent = maxDate;
            }

            // Generate summary
            generateSummary({ avg, min, max, count: allHistoryData.length });
        }

        // Update trend indicator
        function updateTrendIndicator(trendData) {
            const trendElement = document.getElementById('stat-avg-trend');
            if (!trendElement || !trendData.trend) return;

            const trendString = trendData.trend; // "verbessernd", "verschlechternd", "stabil"
            const change = trendData.change_24h || 0;

            trendElement.classList.remove('trend-up', 'trend-down', 'trend-neutral');

            if (trendString === 'verbessernd' || change > 0.05) {
                trendElement.classList.add('trend-up');
                trendElement.innerHTML = `↗ Steigend (+${Math.abs(change).toFixed(2)})`;
            } else if (trendString === 'verschlechternd' || change < -0.05) {
                trendElement.classList.add('trend-down');
                trendElement.innerHTML = `↘ Fallend (${change.toFixed(2)})`;
            } else {
                trendElement.classList.add('trend-neutral');
                trendElement.innerHTML = '→ Stabil';
            }
        }

        // Generate summary text
        function generateSummary(stats) {
            const summaryElement = document.getElementById('summary-text');
            if (!summaryElement) return;

            let mood;
            if (stats.avg > 0.5) mood = "äußerst positiv";
            else if (stats.avg > 0.3) mood = "sehr positiv";
            else if (stats.avg > 0.1) mood = "positiv";
            else if (stats.avg > -0.1) mood = "neutral";
            else if (stats.avg > -0.3) mood = "negativ";
            else if (stats.avg > -0.5) mood = "sehr negativ";
            else mood = "äußerst negativ";

            const summary = `
                Basierend auf ${stats.count} Messungen
                ist die allgemeine Stimmung der Weltlage <strong>${mood}</strong> mit einem Durchschnittswert von <strong>${stats.avg.toFixed(2)}</strong>.
                Die Werte schwanken zwischen ${stats.min.toFixed(2)} und ${stats.max.toFixed(2)}.
            `;

            summaryElement.innerHTML = summary.replace(/\s+/g, ' ').trim();
        }

        // Create all charts
        function createAllCharts() {
            createMainChart();
            createHourlyChart();
            createWeekdayChart();
            createDistributionChart();
            createTrendChart();
        }

        // Switch chart period
        function switchChartPeriod(period) {
            currentPeriod = period;

            // Update tab styling
            document.querySelectorAll('.chart-tab').forEach(tab => {
                tab.classList.remove('active');
                if (tab.getAttribute('data-period') === period) {
                    tab.classList.add('active');
                }
            });

            // Recreate main chart
            if (charts.main) {
                charts.main.destroy();
            }
            createMainChart();
        }

        // Create main sentiment chart
        function createMainChart() {
            const canvas = document.getElementById('main-chart');
            if (!canvas) return;

            let data = [...allHistoryData];

            // Filter by period
            const now = new Date();
            if (currentPeriod === 'week') {
                const weekAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
                data = data.filter(item => new Date(item.timestamp) >= weekAgo);
            } else if (currentPeriod === 'day') {
                const dayAgo = new Date(now.getTime() - 24 * 60 * 60 * 1000);
                data = data.filter(item => new Date(item.timestamp) >= dayAgo);
            }

            // Limit data points for performance
            if (data.length > 500) {
                const step = Math.ceil(data.length / 500);
                data = data.filter((_, i) => i % step === 0);
            }

            const ctx = canvas.getContext('2d');
            charts.main = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: data.map(item => {
                        const date = new Date(item.timestamp);
                        if (currentPeriod === 'day') {
                            return moment(date).format('HH:mm');
                        }
                        return moment(date).format('DD.MM HH:mm');
                    }),
                    datasets: [{
                        label: 'Stimmungswert',
                        data: data.map(item => item.sentiment_score),
                        borderColor: '#3498db',
                        backgroundColor: 'rgba(52, 152, 219, 0.1)',
                        borderWidth: 2,
                        pointRadius: currentPeriod === 'day' ? 2 : 1,
                        pointHoverRadius: 6,
                        tension: 0.3,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            callbacks: {
                                label: context => `Wert: ${context.parsed.y.toFixed(2)}`
                            }
                        }
                    },
                    scales: {
                        x: {
                            ticks: { maxRotation: 45, autoSkip: true, maxTicksLimit: 12 },
                            grid: { display: false }
                        },
                        y: {
                            grid: { drawBorder: false },
                            suggestedMin: -1,
                            suggestedMax: 1
                        }
                    }
                }
            });
        }

        // Create hourly analysis chart
        function createHourlyChart() {
            const canvas = document.getElementById('hourly-chart');
            if (!canvas) return;

            // Calculate hourly averages
            const hourlyData = {};
            allHistoryData.forEach(item => {
                const hour = new Date(item.timestamp).getHours();
                if (!hourlyData[hour]) hourlyData[hour] = { sum: 0, count: 0 };
                hourlyData[hour].sum += item.sentiment_score;
                hourlyData[hour].count += 1;
            });

            const hourlyAverages = Array.from({ length: 24 }, (_, i) => {
                return hourlyData[i] ? hourlyData[i].sum / hourlyData[i].count : 0;
            });

            const ctx = canvas.getContext('2d');
            charts.hourly = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: Array.from({ length: 24 }, (_, i) => `${String(i).padStart(2, '0')}:00`),
                    datasets: [{
                        label: 'Durchschnitt',
                        data: hourlyAverages,
                        backgroundColor: hourlyAverages.map(v => getColorForValue(v, 0.7)),
                        borderColor: hourlyAverages.map(v => getColorForValue(v, 1)),
                        borderWidth: 1,
                        borderRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: context => `Durchschnitt: ${context.parsed.y.toFixed(2)}`
                            }
                        }
                    },
                    scales: {
                        y: {
                            grid: { drawBorder: false },
                            suggestedMin: -1,
                            suggestedMax: 1
                        }
                    }
                }
            });
        }

        // Create weekday analysis chart
        function createWeekdayChart() {
            const canvas = document.getElementById('weekday-chart');
            if (!canvas) return;

            // Calculate weekday averages
            const weekdayData = {};
            allHistoryData.forEach(item => {
                const weekday = new Date(item.timestamp).getDay();
                if (!weekdayData[weekday]) weekdayData[weekday] = { sum: 0, count: 0 };
                weekdayData[weekday].sum += item.sentiment_score;
                weekdayData[weekday].count += 1;
            });

            const weekdayNames = ['Sonntag', 'Montag', 'Dienstag', 'Mittwoch', 'Donnerstag', 'Freitag', 'Samstag'];
            const weekdayAverages = Array.from({ length: 7 }, (_, i) => {
                return weekdayData[i] ? weekdayData[i].sum / weekdayData[i].count : 0;
            });

            const ctx = canvas.getContext('2d');
            charts.weekday = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: weekdayNames,
                    datasets: [{
                        label: 'Durchschnitt',
                        data: weekdayAverages,
                        backgroundColor: weekdayAverages.map(v => getColorForValue(v, 0.7)),
                        borderColor: weekdayAverages.map(v => getColorForValue(v, 1)),
                        borderWidth: 1,
                        borderRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: context => `Durchschnitt: ${context.parsed.y.toFixed(2)}`
                            }
                        }
                    },
                    scales: {
                        y: {
                            grid: { drawBorder: false },
                            suggestedMin: -1,
                            suggestedMax: 1
                        }
                    }
                }
            });
        }

        // Create distribution chart
        function createDistributionChart() {
            const canvas = document.getElementById('distribution-chart');
            if (!canvas) return;

            const buckets = [
                { range: [-1, -0.7], label: 'Sehr negativ', color: 'rgba(192, 57, 43, 0.8)' },
                { range: [-0.7, -0.4], label: 'Negativ', color: 'rgba(231, 76, 60, 0.8)' },
                { range: [-0.4, -0.1], label: 'Leicht negativ', color: 'rgba(243, 156, 18, 0.8)' },
                { range: [-0.1, 0.1], label: 'Neutral', color: 'rgba(149, 165, 166, 0.8)' },
                { range: [0.1, 0.4], label: 'Leicht positiv', color: 'rgba(46, 204, 113, 0.7)' },
                { range: [0.4, 0.7], label: 'Positiv', color: 'rgba(39, 174, 96, 0.8)' },
                { range: [0.7, 1.1], label: 'Sehr positiv', color: 'rgba(33, 150, 83, 0.9)' }
            ];

            const bucketCounts = buckets.map(bucket => ({
                ...bucket,
                count: allHistoryData.filter(item =>
                    item.sentiment_score >= bucket.range[0] &&
                    item.sentiment_score < bucket.range[1]
                ).length
            }));

            const ctx = canvas.getContext('2d');
            charts.distribution = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: bucketCounts.map(b => b.label),
                    datasets: [{
                        label: 'Anzahl',
                        data: bucketCounts.map(b => b.count),
                        backgroundColor: bucketCounts.map(b => b.color),
                        borderWidth: 1,
                        borderRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: context => {
                                    const pct = (context.raw / allHistoryData.length * 100).toFixed(1);
                                    return `Anzahl: ${context.raw} (${pct}%)`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: { grid: { drawBorder: false } }
                    }
                }
            });
        }

        // Create trend chart with trend line
        function createTrendChart() {
            const canvas = document.getElementById('trend-chart');
            if (!canvas) return;

            // Calculate daily averages
            const dailyData = {};
            allHistoryData.forEach(item => {
                const day = moment(item.timestamp).format('YYYY-MM-DD');
                if (!dailyData[day]) {
                    dailyData[day] = { sum: 0, count: 0, date: new Date(item.timestamp) };
                }
                dailyData[day].sum += item.sentiment_score;
                dailyData[day].count += 1;
            });

            const dailyAverages = Object.keys(dailyData).map(day => ({
                day: day,
                displayDay: moment(day).format('DD.MM'),
                value: dailyData[day].sum / dailyData[day].count,
                date: dailyData[day].date
            })).sort((a, b) => a.date - b.date);

            // Calculate trend line
            const xValues = dailyAverages.map((_, i) => i);
            const yValues = dailyAverages.map(d => d.value);
            const n = xValues.length;
            const sumX = xValues.reduce((a, b) => a + b, 0);
            const sumY = yValues.reduce((a, b) => a + b, 0);
            const sumXY = xValues.reduce((a, b, i) => a + b * yValues[i], 0);
            const sumXX = xValues.reduce((a, b) => a + b * b, 0);
            const slope = (n * sumXY - sumX * sumY) / (n * sumXX - sumX * sumX);
            const intercept = (sumY - slope * sumX) / n;
            const trendLine = xValues.map(x => slope * x + intercept);

            const ctx = canvas.getContext('2d');
            charts.trend = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: dailyAverages.map(d => d.displayDay),
                    datasets: [
                        {
                            label: 'Täglicher Durchschnitt',
                            data: dailyAverages.map(d => d.value),
                            borderColor: '#3498db',
                            backgroundColor: 'rgba(52, 152, 219, 0.1)',
                            borderWidth: 2,
                            pointRadius: 4,
                            pointHoverRadius: 6,
                            fill: false,
                            tension: 0.1
                        },
                        {
                            label: 'Trend',
                            data: trendLine,
                            borderColor: '#e74c3c',
                            borderWidth: 2,
                            borderDash: [5, 5],
                            pointRadius: 0,
                            fill: false,
                            tension: 0
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: true, position: 'top' },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            callbacks: {
                                label: context => `${context.dataset.label}: ${context.parsed.y.toFixed(2)}`
                            }
                        }
                    },
                    scales: {
                        y: {
                            grid: { drawBorder: false },
                            suggestedMin: -1,
                            suggestedMax: 1
                        }
                    }
                }
            });
        }

        // Helper function to get color based on sentiment value
        function getColorForValue(value, alpha = 0.7) {
            if (value > 0.5) return `rgba(39, 174, 96, ${alpha})`;
            if (value > 0.2) return `rgba(46, 204, 113, ${alpha})`;
            if (value > 0) return `rgba(52, 152, 219, ${alpha})`;
            if (value > -0.3) return `rgba(243, 156, 18, ${alpha})`;
            if (value > -0.5) return `rgba(231, 76, 60, ${alpha})`;
            return `rgba(192, 57, 43, ${alpha})`;
        }

        // Initialize statistics on page load
        window.addEventListener('load', () => {
            loadStatistics();
            // Refresh statistics every 5 minutes
            setInterval(loadStatistics, 300000);
        });
    </script>
</body>
</html>